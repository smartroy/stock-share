function ship_item(e){var t={},n=$(e).closest("div"),i=n.find('[name="ship_qty"]').val(),a=n.find('[name="cell"]').val(),o=n.find('[name="name"]').val(),l=n.find('[name="addr"]').val();console.log(n),console.log(a),console.log(o),parseInt(i)>0?(item_id=n.attr("id"),t[item_id]={qty:i,name:o,cell:a,addr:l},t=JSON.stringify(t),$.ajax({type:"POST",url:"/order/_item_ship",data:t,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}})):alert("Please the amount you want to ship")}function ship_cancel(e){var t={},n=$(e).closest("tr");console.log(n),item_id=n.attr("id"),t.id=item_id;var i={action:"cancel",items:t};i=JSON.stringify(i),$.ajax({type:"POST",url:"/order/_item_ship_update",data:i,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}})}function ship_release(e){var t={},n=$(e).closest("tr");console.log(n),item_id=n.attr("id"),t.id=item_id;var i={action:"release",items:t};i=JSON.stringify(i),$.ajax({type:"POST",url:"/order/_item_ship_update",data:i,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}})}function ship_edit(e){var t={},n=$(e).closest("tr");console.log(n),item_id=n.attr("id"),t.id=item_id;var i={action:"release",items:t};i=JSON.stringify(i),$.ajax({type:"POST",url:"/order/_item_ship_update",data:i,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}})}$(function(){$("#search_source").bind("click",function(){return $.getJSON("/_search_source",{source:$("#source").find("option:selected").val()},function(e){var t,n='<table class="table table-fixed" id="result_table"><thead><tr><th>Brand</th><th>Name/Nick name</th><th>Color</th><th>New Qty.</th><th>Price</th><th>Note</th></tr></thead><tbody>';if(0==e.length)$("div#sources_result").append("<h2>UPC not found</h2>");else{for(t=0;t<e.length;t++){e[t]._id;n+="<tr name='"+e[t]._id+"''><td name='brand'>"+e[t].brand+"</td><td name='nick_name'><a href=\"/product/product_details/"+e[t]._id+'" target="_blank">'+e[t].name+"/"+e[t].nick_name+"</a></td><td name='color'>"+e[t].color+"</td><td><input type='text' name='qty' size=4 value=0></td><td><input type='text' name='price' size=4 value=0.0></td><td><input type='text' name='note' size=4 style='width:100%;'></td></tr>"}n+="</table>",n+="<button class='actionBtn' type='button' id='add_search' >Add to Order</button>",$("div#sources_result").html(n),$("#add_search").bind("click","#sources_result",function(){var e="";$("#result_table tr").each(function(){var t=$(this).find('[name="qty"]').val();if(parseInt(t)>0){var n=$(this).attr("name"),i=$(this).find('[name="brand"]').text(),a=$(this).find('[name="nick_name"]').text(),o=$(this).find('[name="color"]').text(),l=$(this).find('[name="price"]').val(),s=$(this).find('[name="note"]').val();e+="<tr id='"+n+"''><td name='brand'>"+i+"</td><td name='nick_name'>"+a+"</td><td name='color'>"+o+"</td><td><input type='text' name='qty' size=4 value="+t+"></td><td><input type='text' name='price' size=4 value="+l+"></td><td><input type='text' name='note' size=4 style='width:100%;' value="+s+"></td></tr>"}}),$("#itemtable").append(e)})}}),!1}),$("#submit_order").bind("click","#itemtable",function(){var e={};$("#itemtable tr").each(function(){console.log("in loop"),console.log($(this).html());var t=$(this).find('[name="qty"]').val();if(parseInt(t)>0){var n=$(this).attr("id"),i=$(this).find('[name="price"]').val(),a=$(this).find('[name="note"]').val();e[n]={qty:t,price:i,note:a}}});var t=$("#bill_info").find('[name="bill_name"]').val(),n=$("#bill_info").find('[name="address"]').val(),i=$("#bill_info").find('[name="cellphone"]').val();return e.bill={name:t,addr:n,cellphone:i},e=JSON.stringify(e),$.ajax({type:"POST",url:"/_add_order",data:e,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}}),!1}),$("#submit_email").bind("click","#send_email",function(){var e={};e.email=$("#send_email").find('[name="email"]').val(),e.subject=$("#send_email").find('[name="subject"]').val(),e.email?(e=JSON.stringify(e),$.ajax({type:"POST",url:"/_send_email",data:e,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}})):alert("Please fill in email address")}),$("#add_service").bind("click","#new_service",function(){var e={};e.email=$("#new_service").find('[name="email"]').val(),e.email?(e=JSON.stringify(e),$.ajax({type:"POST",url:"/_add_service",data:e,contentType:"application/json;charset=UTF-8",success:function(e){console.log(e),window.location.href=e}})):alert("Please fill in email address")})});